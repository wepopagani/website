{{ $data := index site.Data site.Language.Lang }}

{{ if $data.contact.contact.enable }}
{{ with $data.contact.contact }}
{{"<!-- Start Contact Us -->" | safeHTML}}
<form id="contact-form" class="contact-us section-bg" method="post" enctype="multipart/form-data" data-netlify="true" netlify-honeypot="bot-field">
	<input type="hidden" name="form-name" value="contact-form">
    <div class="container pb-5">
        <div class="row">
            <div class="col-lg-12">
                {{"<!-- section title -->" | safeHTML}}
                <div class="title text-center wow fadeIn" data-wow-duration="500ms">
                    <h2>{{ with .title }} {{ index (split . " ") 0 | safeHTML }} {{ end }}<span class="color">
                            {{ with .title }} {{ after (len (index (split . " ") 0)) . | safeHTML }} {{ end }}</span></h2>
                    <div class="border-meghna"></div>
                </div>
            </div>
            {{"<!-- /section title -->" | safeHTML}}

            {{"<!-- Contact Details -->" | safeHTML}}
            <div class="contact-info col-lg-6 wow fadeInUp" data-wow-duration="500ms">
                <h3>{{ .subtitle | markdownify }}</h3>
                <p> {{ .content | markdownify }} </p>

                {{ if .contact_form.enable }}
                <div class="contact-details">
                    {{ range .contact_list }}
                    <div class="con-info clearfix">
                        <i class="{{ .icon }}"></i>
                        <span>{{ .info }}</span>
                    </div>
                    {{ end }}
                </div>
                {{ end }}
            </div>

            {{"<!-- Contact Form -->" | safeHTML}}
            {{ if .contact_form.enable }}
            {{ with .contact_form }}
            <div class="col-lg-6 wow fadeInUp" data-wow-duration="500ms" data-wow-delay="300ms">
                <form id="contact-form" class="form-meghna" method="post" enctype="multipart/form-data" data-netlify="true" data-netlify-recaptcha="true" netlify-honeypot="bot-field">
                    <div class="form-group">
                        <input type="name" placeholder="{{ .name }}" class="form-control" name="name" id="name" required>
                    </div>
                    <div class="form-group">
                        <input type="email" placeholder="{{ .email }}" class="form-control" name="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <input type="text" placeholder="{{ .subject }}" class="form-control" name="subject" id="subject" required>
                    </div>
                    <div class="form-group">
                        <textarea rows="6" placeholder="{{ .message }}" class="form-control" name="message" id="message" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="file-upload" class="form-label">Carica immagini o il tuo modello</label>
                        <input type="file" class="form-control" name="file-upload" id="file-upload">
                    </div>
                    <div id="cf-submit">
                        <button type="submit" id="contact-submit" class="btn btn-transparent btn-block" value="{{ .submit }}">{{ .submit }}</button>
                    </div>
                    <div style="display: none;">
                        <label>Don't fill this out if you're human: <input name="bot-field"></label>
                    </div>
                </form>
                <div id="success-message" class="alert alert-success mt-4" style="display: none;">
                    <strong>Grazie!</strong> Il tuo messaggio è stato inviato con successo.
                </div>
                <div id="error-message" class="alert alert-danger mt-4" style="display: none;">
                    <strong>Errore!</strong> Si è verificato un problema durante l'invio del modulo. Riprova più tardi.
                </div>
            </div>
            {{ end }}
            {{ else }}
            <div class="contact-details">
                {{ range .contact_list }}
                <div class="con-info clearfix">
                    <i class="{{ .icon }}"></i>
                    <span>{{ .info }}</span>
                </div>
                {{ end }}
            </div>
            {{ end }}
        </div>
    </div>
</section>
{{"<!-- /contact -->" | safeHTML}}
{{ end }}
{{ end }}

<script>
document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("contact-form");
    const successMessage = document.getElementById("success-message");
    const errorMessage = document.getElementById("error-message");

    form.addEventListener("submit", function (event) {
        event.preventDefault();

        // Mostra il messaggio di successo direttamente per dimostrazione
        form.reset();
        successMessage.style.display = "block";
        errorMessage.style.display = "none";

        // Se desideri inviare i dati a un altro endpoint:
        // const formData = new FormData(form);
        // fetch("/", {
        //     method: "POST",
        //     headers: {
        //         "Content-Type": "application/x-www-form-urlencoded"
        //     },
        //     body: new URLSearchParams(formData).toString()
        // })
        // .then(response => {
        //     if (response.ok) {
        //         form.reset();
        //         successMessage.style.display = "block";
        //         errorMessage.style.display = "none";
        //     } else {
        //         throw new Error("Network response was not ok");
        //     }
        // })
        // .catch(error => {
        //     console.error("There was a problem with your submission:", error);
        //     successMessage.style.display = "none";
        //     errorMessage.style.display = "block";
        // });
    });
});
</script>
